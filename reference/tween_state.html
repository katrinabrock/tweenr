<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Compose tweening between states — tween_state • tweenr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Compose tweening between states — tween_state" />
<meta property="og:description" content="The tween_state() is a counterpart to tween_states() that is aimed at
letting you gradually build up a scene by composing state changes one by one.
This setup lets you take more control over each state change and allows you
to work with datasets with uneven number of rows, flexibly specifying what
should happen with entering and exiting data. keep_state() is a simpel
helper for letting you pause at a state. open_state() is a shortcut from
tweening from an empty dataset with a given enter() function while
close_state() is the same but will instead tween into an empty dataset with
a given exit() function." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tweenr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.2.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/thomasp85/tweenr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Compose tweening between states</h1>
    <small class="dont-index">Source: <a href='https://github.com/thomasp85/tweenr/blob/master/R/tween_state.R'><code>R/tween_state.R</code></a></small>
    <div class="hidden name"><code>tween_state.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>tween_state()</code> is a counterpart to <code><a href='tween_states.html'>tween_states()</a></code> that is aimed at
letting you gradually build up a scene by composing state changes one by one.
This setup lets you take more control over each state change and allows you
to work with datasets with uneven number of rows, flexibly specifying what
should happen with entering and exiting data. <code>keep_state()</code> is a simpel
helper for letting you pause at a state. <code>open_state()</code> is a shortcut from
tweening from an empty dataset with a given <code>enter()</code> function while
<code>close_state()</code> is the same but will instead tween into an empty dataset with
a given <code>exit()</code> function.</p>
    </div>

    <pre class="usage"><span class='fu'>tween_state</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>to</span>, <span class='va'>ease</span>, <span class='va'>nframes</span>, id <span class='op'>=</span> <span class='cn'>NULL</span>, enter <span class='op'>=</span> <span class='cn'>NULL</span>, exit <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>keep_state</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>nframes</span><span class='op'>)</span>

<span class='fu'>open_state</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>ease</span>, <span class='va'>nframes</span>, <span class='va'>enter</span><span class='op'>)</span>

<span class='fu'>close_state</span><span class='op'>(</span><span class='va'>.data</span>, <span class='va'>ease</span>, <span class='va'>nframes</span>, <span class='va'>exit</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.data</th>
      <td><p>A data.frame to start from. If <code>.data</code> is the result of a prior
tween, only the last frame will be used for the tween. The new tween will
then be added to the prior tween</p></td>
    </tr>
    <tr>
      <th>to</th>
      <td><p>A data.frame to end at. It must contain the same columns as .data
(exluding <code>.frame</code>)</p></td>
    </tr>
    <tr>
      <th>ease</th>
      <td><p>The easing function to use. Either a single string or one for
each column in the data set.</p></td>
    </tr>
    <tr>
      <th>nframes</th>
      <td><p>The number of frames to calculate for the tween</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>The column to match observations on. If <code>NULL</code> observations will be
matched by position. See the <em>Match, Enter, and Exit</em> section for more
information.</p></td>
    </tr>
    <tr>
      <th>enter, exit</th>
      <td><p>functions that calculate a start state for new observations
that appear in <code>to</code> or an end state for observations that are not present in
<code>to</code>. If <code>NULL</code> the new/old observations will not be part of the tween. The
function gets a data.frame with either the start state of the exiting
observations, or the end state of the entering observations and must return
a modified version of that data.frame. See the <em>Match, Enter, and Exit</em>
section for more information.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data.frame containing all the intermediary states in the tween,
each state will be enumerated by the <code>.frame</code> column</p>
    <h2 class="hasAnchor" id="match-enter-and-exit"><a class="anchor" href="#match-enter-and-exit"></a>Match, Enter, and Exit</h2>

    

<p>When there are discrepancies between the two states to tweeen between you
need a way to resolve the discrepancy before calculating the intermediary
states. With discrepancies we mean that some data points are present in the
start state and not in the end state, and/or some are present in the end
state but not in the start state. A simple example is that the start state
contains 100 rows and the end state contains 70. There are 30 missing rows
that we need to do something about before we can calculate the tween.</p>
<p><strong>Making pairs</strong>
The first question to answer is "How do we know which observations are
disappearing (<em>exiting</em>) and/or appearing (<em>entering</em>)?". This is done with
the <code>id</code> argument which should give a column name to match rows between the
two states on. If <code>id = NULL</code> the rows will be matched by position (in the
above example the last 30 rows in the start state will be entering). The <code>id</code>
column must only contain unique values in order to work.</p>
<p><strong>Making up states</strong>
Once the rows in each state has been paired you'll end up with three sets of
data. One containing rows that is present in both the start and end state,
one containing rows only present in the start state, and one only containing
rows present in the end state. The first group is easy - here you just tween
between each rows - but for the other two we'll need some state to start or
end the tween with. This is really the purpose of the <code>enter</code> and <code>exit</code>
functions. They take a data frame containing the subset of data that has not
been matched and must return a new data frame giving the state that these
rows must be tweened from/into. A simple example could be an <code>enter</code> function
that sets the variable giving the opacity in the plot to 0 - this will make
the new points fade into view during the transition.</p>
<p><strong>Ignoring discrepancies</strong>
The default values for <code>enter</code> and <code>exit</code> is <code>NULL</code>. This value indicate that
non-matching rows should simply be ignored for the transition and simply
appear in the last frame of the tween. This is the default.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>data1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  x <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>20</span>,
  y <span class='op'>=</span> <span class='fl'>0</span>,
  colour <span class='op'>=</span> <span class='st'>'forestgreen'</span>,
  stringsAsFactors <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>
<span class='va'>data2</span> <span class='op'>&lt;-</span> <span class='va'>data1</span>
<span class='va'>data2</span><span class='op'>$</span><span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fl'>20</span><span class='op'>:</span><span class='fl'>1</span>
<span class='va'>data2</span><span class='op'>$</span><span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fl'>1</span>

<span class='va'>data</span> <span class='op'>&lt;-</span> <span class='va'>data1</span> <span class='op'>%&gt;%</span>
  <span class='fu'>tween_state</span><span class='op'>(</span><span class='va'>data2</span>, <span class='st'>'linear'</span>, <span class='fl'>50</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>keep_state</span><span class='op'>(</span><span class='fl'>20</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>tween_state</span><span class='op'>(</span><span class='va'>data1</span>, <span class='st'>'bounce-out'</span>, <span class='fl'>50</span><span class='op'>)</span>

<span class='co'># Using enter and exit (made up numbers)</span>
<span class='va'>df1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  country <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Denmark'</span>, <span class='st'>'Sweden'</span>, <span class='st'>'Norway'</span><span class='op'>)</span>,
  population <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>5e6</span>, <span class='fl'>10e6</span>, <span class='fl'>3.5e6</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>df2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  country <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Denmark'</span>, <span class='st'>'Sweden'</span>, <span class='st'>'Norway'</span>, <span class='st'>'Finland'</span><span class='op'>)</span>,
  population <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6e6</span>, <span class='fl'>10.5e6</span>, <span class='fl'>4e6</span>, <span class='fl'>3e6</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>df3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
  country <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'Denmark'</span>, <span class='st'>'Norway'</span><span class='op'>)</span>,
  population <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10e6</span>, <span class='fl'>6e6</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>to_zero</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>x</span><span class='op'>$</span><span class='va'>population</span> <span class='op'>&lt;-</span> <span class='fl'>0</span>
  <span class='va'>x</span>
<span class='op'>}</span>
<span class='va'>pop_devel</span> <span class='op'>&lt;-</span> <span class='va'>df1</span> <span class='op'>%&gt;%</span>
  <span class='fu'>tween_state</span><span class='op'>(</span><span class='va'>df2</span>, <span class='st'>'cubic-in-out'</span>, <span class='fl'>50</span>, id <span class='op'>=</span> <span class='va'>country</span>, enter <span class='op'>=</span> <span class='va'>to_zero</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>tween_state</span><span class='op'>(</span><span class='va'>df3</span>, <span class='st'>'cubic-in-out'</span>, <span class='fl'>50</span>, id <span class='op'>=</span> <span class='va'>country</span>, enter <span class='op'>=</span> <span class='va'>to_zero</span>,
              exit <span class='op'>=</span> <span class='va'>to_zero</span><span class='op'>)</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Thomas Lin Pedersen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


